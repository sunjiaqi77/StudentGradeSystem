{"remainingRequest":"D:\\Idea项目\\Student\\student_client\\node_modules\\babel-loader\\lib\\index.js!D:\\Idea项目\\Student\\student_client\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\Idea项目\\Student\\student_client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Idea项目\\Student\\student_client\\src\\views\\Teacher\\teacherGradeCourseManage\\teacherQueryGradeCourse.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Idea项目\\Student\\student_client\\src\\views\\Teacher\\teacherGradeCourseManage\\teacherQueryGradeCourse.vue","mtime":1687272485097},{"path":"D:\\Idea项目\\Student\\student_client\\babel.config.js","mtime":1644576637000},{"path":"D:\\Idea项目\\Student\\student_client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1685794117013},{"path":"D:\\Idea项目\\Student\\student_client\\node_modules\\babel-loader\\lib\\index.js","mtime":1685794121019},{"path":"D:\\Idea项目\\Student\\student_client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1685794117013},{"path":"D:\\Idea项目\\Student\\student_client\\node_modules\\vue-loader\\lib\\index.js","mtime":1685794120760}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgKiBhcyBYTFNYIGZyb20gJ3hsc3gnOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNsYXNzTGlzdDogW10sCiAgICAgIHN0dWRlbnRMaXN0OiBbXSwKICAgICAgY291cnNlTGlzdDogW10sCiAgICAgIGdyYWRlTGlzdDogW10sCiAgICAgIHN1bUxpc3Q6IFtdLAogICAgICBhdmdMaXN0OiBbXSwKICAgICAgcnVsZUZvcm06IHsKICAgICAgICBjbGFzc0lkQ2hvb3NlOiAiIgogICAgICB9CiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgZXhwb3J0R3JhZGVzOiBmdW5jdGlvbiBleHBvcnRHcmFkZXMoKSB7CiAgICAgIHZhciB0YWJsZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3R5bGVkLXRhYmxlJyk7IC8vIOS9v+eUqOebuOW6lOeahCBIVE1MIOihqOagvOWFg+e0oOeahCBJRCDmiJblhbbku5bpgInmi6nlmajmnaXojrflj5booajmoLzlhYPntKAKCiAgICAgIHZhciB3b3Jrc2hlZXQgPSBYTFNYLnV0aWxzLnRhYmxlX3RvX3NoZWV0KHRhYmxlRWxlbWVudCk7CiAgICAgIHZhciB3b3JrYm9vayA9IFhMU1gudXRpbHMuYm9va19uZXcoKTsKICAgICAgWExTWC51dGlscy5ib29rX2FwcGVuZF9zaGVldCh3b3JrYm9vaywgd29ya3NoZWV0LCAn5oiQ57up6KGoJyk7CiAgICAgIHZhciB0b2RheSA9IG5ldyBEYXRlKCk7CiAgICAgIHZhciBmaWxlbmFtZSA9ICJcdTYyMTBcdTdFRTlcdTg4NjhfIi5jb25jYXQodG9kYXkuZ2V0RnVsbFllYXIoKSkuY29uY2F0KHRvZGF5LmdldE1vbnRoKCkgKyAxKS5jb25jYXQodG9kYXkuZ2V0RGF0ZSgpLCAiLnhsc3giKTsKICAgICAgWExTWC53cml0ZUZpbGUod29ya2Jvb2ssIGZpbGVuYW1lKTsKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICB0aGF0LnRpZCA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3RpZCcpOwogICAgYXhpb3MuZ2V0KCJodHRwOi8vbG9jYWxob3N0OjEwMDg2L2NvdXJzZS9maW5kQ2xhc3NJZD90aWQ9IiArIHRoaXMudGlkKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgIHRoYXQuY2xhc3NMaXN0ID0gcmVzcC5kYXRhOwogICAgfSk7CiAgfSwKICB3YXRjaDogewogICAgInJ1bGVGb3JtLmNsYXNzSWRDaG9vc2UiOiB7CiAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIGhhbmRsZXIobmV3Q2hvb3NlLCBvbGQpIHsKICAgICAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICAgICAgYXhpb3MuZ2V0KCJodHRwOi8vbG9jYWxob3N0OjEwMDg2L3N0dWRlbnQvZmluZEJ5Q2xhc3NOYW1lP2NsYXNzSWQ9IiArIG5ld0Nob29zZSkudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgICAgdGhhdC5zdHVkZW50TGlzdCA9IHJlc3AuZGF0YTsKICAgICAgICAgIGNvbnNvbGUubG9nKHRoYXQuc3R1ZGVudExpc3QpOwogICAgICAgICAgYXhpb3MuZ2V0KCJodHRwOi8vbG9jYWxob3N0OjEwMDg2L2NvdXJzZS9maW5kQnlDbGFzc0lkP2NsYXNzaWQ9IiArIG5ld0Nob29zZSkudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgICAgICB0aGF0LmNvdXJzZUxpc3QgPSByZXNwLmRhdGE7CiAgICAgICAgICAgIHZhciByZXF1ZXN0czEgPSBbXTsKCiAgICAgICAgICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKGkpIHsKICAgICAgICAgICAgICAvLyDlrprkuYnkuIDkuKrmlbDnu4TmnaXkv53lrZjmiYDmnInnmoTlvILmraXor7fmsYIKICAgICAgICAgICAgICB2YXIgcmVxdWVzdHMgPSBbXTsgLy8g5Y+R6LW35byC5q2l6K+35rGCCgogICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhhdC5jb3Vyc2VMaXN0Lmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IGF4aW9zLmdldCgiaHR0cDovL2xvY2FsaG9zdDoxMDA4Ni9TQ1QvZmluZD9zaWQ9IiArIHRoYXQuc3R1ZGVudExpc3RbaV0uc2lkICsgIiZjaWQ9IiArIHRoYXQuY291cnNlTGlzdFtqXS5jaWQpOwogICAgICAgICAgICAgICAgcmVxdWVzdHMucHVzaChyZXF1ZXN0KTsKICAgICAgICAgICAgICAgIHJlcXVlc3RzMS5wdXNoKHJlcXVlc3QpOwogICAgICAgICAgICAgIH0gLy8g5L2/55SoIFByb21pc2UuYWxsIOetieW+heaJgOacieW8guatpeivt+axguWujOaIkAoKCiAgICAgICAgICAgICAgUHJvbWlzZS5hbGwocmVxdWVzdHMpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlcykgewogICAgICAgICAgICAgICAgdmFyIHN1bSA9IDAuMDsKICAgICAgICAgICAgICAgIHZhciBhdmcgPSAwLjA7CiAgICAgICAgICAgICAgICB2YXIgdGVtcExpc3QgPSBbXTsgLy8g5aSE55CG5q+P5Liq5byC5q2l6K+35rGC55qE5ZON5bqUCgogICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCByZXF1ZXN0cy5sZW5ndGg7IGsrKykgewogICAgICAgICAgICAgICAgICB2YXIgX3Jlc3AgPSByZXNwb25zZXNba107CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKF9yZXNwKTsKCiAgICAgICAgICAgICAgICAgIGlmIChfcmVzcC5kYXRhICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBzdW0gPSBzdW0gKyBfcmVzcC5kYXRhLmdyYWRlOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICB0ZW1wTGlzdC5wdXNoKF9yZXNwLmRhdGEpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGF2ZyA9IHN1bSAvIHRlbXBMaXN0Lmxlbmd0aDsKICAgICAgICAgICAgICAgIHRoYXQuYXZnTGlzdC5wdXNoKGF2Zyk7CiAgICAgICAgICAgICAgICB0aGF0LnN1bUxpc3QucHVzaChzdW0pOwogICAgICAgICAgICAgICAgdGhhdC5ncmFkZUxpc3QucHVzaCh0ZW1wTGlzdCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoYXQuc3R1ZGVudExpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICBfbG9vcChpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgUHJvbWlzZS5hbGwocmVxdWVzdHMxKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZXMpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0aGF0LnN0dWRlbnRMaXN0KTsKCiAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IHRoYXQuc3R1ZGVudExpc3QubGVuZ3RoOyBfaSsrKSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoYXQuc3R1ZGVudExpc3QubGVuZ3RoIC0gX2kgLSAxOyBqKyspIHsKICAgICAgICAgICAgICAgICAgaWYgKHRoYXQuYXZnTGlzdFtqXSA8IHRoYXQuYXZnTGlzdFtqICsgMV0pIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdCA9IHRoYXQuYXZnTGlzdFtqXTsKICAgICAgICAgICAgICAgICAgICB0aGF0LmF2Z0xpc3Rbal0gPSB0aGF0LmF2Z0xpc3RbaiArIDFdOwogICAgICAgICAgICAgICAgICAgIHRoYXQuYXZnTGlzdFtqICsgMV0gPSB0OwogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoYXQuc3R1ZGVudExpc3RbaiArIDFdKTsKICAgICAgICAgICAgICAgICAgICB0ID0gdGhhdC5zdHVkZW50TGlzdFtqXTsKICAgICAgICAgICAgICAgICAgICB0aGF0LnN0dWRlbnRMaXN0W2pdID0gdGhhdC5zdHVkZW50TGlzdFtqICsgMV07CiAgICAgICAgICAgICAgICAgICAgdGhhdC5zdHVkZW50TGlzdFtqICsgMV0gPSB0OwogICAgICAgICAgICAgICAgICAgIHQgPSB0aGF0LmdyYWRlTGlzdFtqXTsKICAgICAgICAgICAgICAgICAgICB0aGF0LmdyYWRlTGlzdFtqXSA9IHRoYXQuZ3JhZGVMaXN0W2ogKyAxXTsKICAgICAgICAgICAgICAgICAgICB0aGF0LmdyYWRlTGlzdFtqICsgMV0gPSB0OwogICAgICAgICAgICAgICAgICAgIHQgPSB0aGF0LnN1bUxpc3Rbal07CiAgICAgICAgICAgICAgICAgICAgdGhhdC5zdW1MaXN0W2pdID0gdGhhdC5zdW1MaXN0W2ogKyAxXTsKICAgICAgICAgICAgICAgICAgICB0aGF0LnN1bUxpc3RbaiArIDFdID0gdDsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0KfTs="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6EA;AACA;AACAA,MADA,kBACA;AACA;AACAC,mBADA;AAEAC,qBAFA;AAGAC,oBAHA;AAIAC,mBAJA;AAKAC,iBALA;AAMAC,iBANA;AAOAC;AACAC;AADA;AAPA;AAWA,GAbA;AAcAC;AACAC,gBADA,0BACA;AACA,iEADA,CACA;;AACA;AAEA;AACAC;AAEA;AACA;AAEAA;AACA;AAZA,GAdA;AA4BAC,SA5BA,qBA4BA;AACA;AACAC;AAEAC;AACAD;AACA,KAFA;AAGA,GAnCA;AAoCAE;AACA;AACAC,aADA,mBACAC,SADA,EACAC,GADA,EACA;AACA;AACAJ;AACAD;AACAM;AACAL;AACAD;AACA;;AAFA,uCAGAO,CAHA;AAIA;AACA,gCALA,CAMA;;AACA;AACA;AACAC;AACAC;AACA,eAXA,CAYA;;;AACAC;AACA;AACA;AACA,kCAHA,CAIA;;AACA;AACA;AACAJ;;AAEA;AACAK;AACA;;AACAC;AACA;;AACAC;AACAb;AACAA;AACAA;AACA,eAlBA;AAbA;;AAGA;AAAA;AA6BA;;AACAU;AACAJ;;AACA;AACA;AACA;AACA;AACAN;AACAA;AACAM;AACAQ;AACAd;AACAA;AAEAc;AACAd;AACAA;AACAc;AACAd;AACAA;AACA;AACA;AACA;AACA,aAtBA;AAuBA,WAxDA;AAyDA,SA5DA;AA6DA;AAhEA;AADA;AApCA","names":["data","classList","studentList","courseList","gradeList","sumList","avgList","ruleForm","classIdChoose","methods","exportGrades","XLSX","created","that","axios","watch","handler","newChoose","old","console","i","requests","requests1","Promise","sum","tempList","avg","t"],"sourceRoot":"src/views/Teacher/teacherGradeCourseManage","sources":["teacherQueryGradeCourse.vue"],"sourcesContent":["<template>\n  <div>\n    <el-container>\n      <el-main>\n        <el-card>\n          <el-form>\n            <el-form-item label=\"班级名称\" prop=\"classChoose\">\n              <el-select v-model=\"ruleForm.classIdChoose\" placeholder=\"请选择\">\n                <el-option\n                  v-for=\"classes in classList\"\n                  :key=\"classes.id\"\n                  :label=\"classes.name\"\n                  :value=\"classes.id\"\n                ></el-option>\n              </el-select>\n            </el-form-item>\n          </el-form>\n        </el-card>\n        <table class=\"styled-table\" id=\"styled-table\">\n          <thead>\n            <tr>\n              <th>姓名</th>\n              <template v-for=\"course in courseList\">\n                <th>{{ course.cname }}</th>\n              </template>\n              <th>总分</th>\n              <th>平均分</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(student, index) in studentList\" :key=\"index\">\n              <td>{{ student.sname }}</td>\n              <template v-for=\"grade in gradeList[index]\">\n                <td v-if=\"grade != null\">{{ grade.grade }}</td>\n                <td v-else>无</td>\n              </template>\n              <td>{{ sumList[index] }}</td>\n              <td>{{ avgList[index] }}</td>\n            </tr>\n          </tbody>\n        </table>\n      </el-main>\n    </el-container>\n    <button @click=\"exportGrades\">导出成绩</button>\n  </div>\n</template>\n\n<style>\n.styled-table {\n  width: 100%;\n  border-collapse: collapse;\n  margin-top: 20px;\n}\n\n.styled-table th,\n.styled-table td {\n  padding: 10px;\n  border: 1px solid #ccc;\n  text-align: center;\n}\n\n.styled-table th {\n  background-color: #f2f2f2;\n  font-weight: bold;\n}\n\n.styled-table tr:nth-child(even) {\n  background-color: #f8f8f8;\n}\n\n.styled-table tr:hover {\n  background-color: #e2e2e2;\n}\n</style>\n\n\n<script>\nimport * as XLSX from 'xlsx';\nexport default {\n  data() {\n    return {\n      classList: [],\n      studentList: [],\n      courseList: [],\n      gradeList: [],\n      sumList: [],\n      avgList: [],\n      ruleForm: {\n        classIdChoose: \"\",\n      }\n    };\n  },\n  methods: {\n    exportGrades() {\n      const tableElement = document.getElementById('styled-table'); // 使用相应的 HTML 表格元素的 ID 或其他选择器来获取表格元素\n      const worksheet = XLSX.utils.table_to_sheet(tableElement);\n\n      const workbook = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(workbook, worksheet, '成绩表');\n\n      const today = new Date();\n      const filename = `成绩表_${today.getFullYear()}${today.getMonth() + 1}${today.getDate()}.xlsx`;\n\n      XLSX.writeFile(workbook, filename);\n    }\n  },\n  created() {\n    const that = this\n    that.tid = sessionStorage.getItem('tid');\n\n    axios.get(\"http://localhost:10086/course/findClassId?tid=\" + this.tid).then(function (resp) {\n      that.classList = resp.data;\n    })\n  },\n  watch: {\n    \"ruleForm.classIdChoose\": {\n      handler(newChoose, old) {\n        const that = this\n        axios.get(\"http://localhost:10086/student/findByClassName?classId=\" + newChoose).then(function (resp) {\n          that.studentList = resp.data;\n          console.log(that.studentList);\n          axios.get(\"http://localhost:10086/course/findByClassId?classid=\" + newChoose).then(function (resp) {\n            that.courseList = resp.data;\n            const requests1 = [];\n            for (let i = 0; i < that.studentList.length; i++) {\n              // 定义一个数组来保存所有的异步请求\n              const requests = [];\n              // 发起异步请求\n              for (let j = 0; j < that.courseList.length; j++) {\n                const request = axios.get(\"http://localhost:10086/SCT/find?sid=\" + that.studentList[i].sid + \"&cid=\" + that.courseList[j].cid);\n                requests.push(request);\n                requests1.push(request);\n              }\n              // 使用 Promise.all 等待所有异步请求完成\n              Promise.all(requests).then(function (responses) {\n                let sum = 0.0;\n                let avg = 0.0;\n                let tempList = [];\n                // 处理每个异步请求的响应\n                for (let k = 0; k < requests.length; k ++) {\n                  const resp = responses[k];\n                  console.log(resp);\n\n                  if (resp.data != null) {\n                    sum = sum + resp.data.grade;\n                  }\n                  tempList.push(resp.data);\n                }\n                avg = sum / tempList.length;\n                that.avgList.push(avg);\n                that.sumList.push(sum);\n                that.gradeList.push(tempList);\n              });\n            }\n            Promise.all(requests1).then(function (responses) {\n              console.log(that.studentList);\n              for (let i = 0; i < that.studentList.length; i++) {\n                for (let j = 0; j < that.studentList.length - i - 1; j++) {\n                  if (that.avgList[j] < that.avgList[j + 1]) {\n                    let t = that.avgList[j];\n                    that.avgList[j] = that.avgList[j + 1];\n                    that.avgList[j + 1] = t;\n                    console.log(that.studentList[j + 1]);\n                    t = that.studentList[j];\n                    that.studentList[j] = that.studentList[j + 1];\n                    that.studentList[j + 1] = t;\n                    \n                    t = that.gradeList[j];\n                    that.gradeList[j] = that.gradeList[j + 1];\n                    that.gradeList[j + 1] = t;\n                    t = that.sumList[j];\n                    that.sumList[j] = that.sumList[j + 1];\n                    that.sumList[j + 1] = t;\n                  }\n                }\n              }\n            })\n          })\n        }\n      )}\n    }\n  }\n}\n</script>"]}]}