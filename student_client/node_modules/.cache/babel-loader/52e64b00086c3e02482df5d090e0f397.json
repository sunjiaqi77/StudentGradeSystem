{"remainingRequest":"D:\\Idea项目\\Student\\student_client\\node_modules\\babel-loader\\lib\\index.js!D:\\Idea项目\\Student\\student_client\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\Idea项目\\Student\\student_client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Idea项目\\Student\\student_client\\src\\views\\Teacher\\teacherGradeCourseManage\\teacherQueryGradeCourse.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Idea项目\\Student\\student_client\\src\\views\\Teacher\\teacherGradeCourseManage\\teacherQueryGradeCourse.vue","mtime":1687269747980},{"path":"D:\\Idea项目\\Student\\student_client\\babel.config.js","mtime":1644576637000},{"path":"D:\\Idea项目\\Student\\student_client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1685794117013},{"path":"D:\\Idea项目\\Student\\student_client\\node_modules\\babel-loader\\lib\\index.js","mtime":1685794121019},{"path":"D:\\Idea项目\\Student\\student_client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1685794117013},{"path":"D:\\Idea项目\\Student\\student_client\\node_modules\\vue-loader\\lib\\index.js","mtime":1685794120760}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgKiBhcyBYTFNYIGZyb20gJ3hsc3gnOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNsYXNzTGlzdDogW10sCiAgICAgIHN0dWRlbnRMaXN0OiBbXSwKICAgICAgY291cnNlTGlzdDogW10sCiAgICAgIGdyYWRlTGlzdDogW10sCiAgICAgIHN1bUxpc3Q6IFtdLAogICAgICBhdmdMaXN0OiBbXSwKICAgICAgcnVsZUZvcm06IHsKICAgICAgICBjbGFzc0lkQ2hvb3NlOiAiIgogICAgICB9CiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgZXhwb3J0R3JhZGVzOiBmdW5jdGlvbiBleHBvcnRHcmFkZXMoKSB7CiAgICAgIHZhciB3b3Jrc2hlZXQgPSBYTFNYLnV0aWxzLnRhYmxlX3RvX3NoZWV0KHRoaXMuJHJlZnMuZ3JhZGVMaXN0KTsKICAgICAgdmFyIHdvcmtib29rID0gWExTWC51dGlscy5ib29rX25ldygpOwogICAgICBYTFNYLnV0aWxzLmJvb2tfYXBwZW5kX3NoZWV0KHdvcmtib29rLCB3b3Jrc2hlZXQsICfmiJDnu6nooagnKTsKICAgICAgdmFyIHRvZGF5ID0gbmV3IERhdGUoKTsKICAgICAgdmFyIGZpbGVuYW1lID0gIlx1NjIxMFx1N0VFOVx1ODg2OF8iLmNvbmNhdCh0b2RheS5nZXRGdWxsWWVhcigpKS5jb25jYXQodG9kYXkuZ2V0TW9udGgoKSArIDEpLmNvbmNhdCh0b2RheS5nZXREYXRlKCksICIueGxzeCIpOwogICAgICBYTFNYLndyaXRlRmlsZSh3b3JrYm9vaywgZmlsZW5hbWUpOwogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHZhciB0aGF0ID0gdGhpczsKICAgIHRoYXQudGlkID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndGlkJyk7CiAgICBheGlvcy5nZXQoImh0dHA6Ly9sb2NhbGhvc3Q6MTAwODYvY291cnNlL2ZpbmRDbGFzc0lkP3RpZD0iICsgdGhpcy50aWQpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgdGhhdC5jbGFzc0xpc3QgPSByZXNwLmRhdGE7CiAgICB9KTsKICB9LAogIHdhdGNoOiB7CiAgICAicnVsZUZvcm0uY2xhc3NJZENob29zZSI6IHsKICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcihuZXdDaG9vc2UsIG9sZCkgewogICAgICAgIHZhciB0aGF0ID0gdGhpczsKICAgICAgICBheGlvcy5nZXQoImh0dHA6Ly9sb2NhbGhvc3Q6MTAwODYvc3R1ZGVudC9maW5kQnlDbGFzc05hbWU/Y2xhc3NJZD0iICsgbmV3Q2hvb3NlKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgICB0aGF0LnN0dWRlbnRMaXN0ID0gcmVzcC5kYXRhOwogICAgICAgICAgY29uc29sZS5sb2codGhhdC5zdHVkZW50TGlzdCk7CiAgICAgICAgICBheGlvcy5nZXQoImh0dHA6Ly9sb2NhbGhvc3Q6MTAwODYvY291cnNlL2ZpbmRCeUNsYXNzSWQ/Y2xhc3NpZD0iICsgbmV3Q2hvb3NlKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgICAgIHRoYXQuY291cnNlTGlzdCA9IHJlc3AuZGF0YTsKICAgICAgICAgICAgdmFyIHJlcXVlc3RzMSA9IFtdOwoKICAgICAgICAgICAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoaSkgewogICAgICAgICAgICAgIC8vIOWumuS5ieS4gOS4quaVsOe7hOadpeS/neWtmOaJgOacieeahOW8guatpeivt+axggogICAgICAgICAgICAgIHZhciByZXF1ZXN0cyA9IFtdOyAvLyDlj5HotbflvILmraXor7fmsYIKCiAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGF0LmNvdXJzZUxpc3QubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gYXhpb3MuZ2V0KCJodHRwOi8vbG9jYWxob3N0OjEwMDg2L1NDVC9maW5kP3NpZD0iICsgdGhhdC5zdHVkZW50TGlzdFtpXS5zaWQgKyAiJmNpZD0iICsgdGhhdC5jb3Vyc2VMaXN0W2pdLmNpZCk7CiAgICAgICAgICAgICAgICByZXF1ZXN0cy5wdXNoKHJlcXVlc3QpOwogICAgICAgICAgICAgICAgcmVxdWVzdHMxLnB1c2gocmVxdWVzdCk7CiAgICAgICAgICAgICAgfSAvLyDkvb/nlKggUHJvbWlzZS5hbGwg562J5b6F5omA5pyJ5byC5q2l6K+35rGC5a6M5oiQCgoKICAgICAgICAgICAgICBQcm9taXNlLmFsbChyZXF1ZXN0cykudGhlbihmdW5jdGlvbiAocmVzcG9uc2VzKSB7CiAgICAgICAgICAgICAgICB2YXIgc3VtID0gMC4wOwogICAgICAgICAgICAgICAgdmFyIGF2ZyA9IDAuMDsKICAgICAgICAgICAgICAgIHZhciB0ZW1wTGlzdCA9IFtdOyAvLyDlpITnkIbmr4/kuKrlvILmraXor7fmsYLnmoTlk43lupQKCiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHJlcXVlc3RzLmxlbmd0aDsgaysrKSB7CiAgICAgICAgICAgICAgICAgIHZhciBfcmVzcCA9IHJlc3BvbnNlc1trXTsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coX3Jlc3ApOwoKICAgICAgICAgICAgICAgICAgaWYgKF9yZXNwLmRhdGEgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIHN1bSA9IHN1bSArIF9yZXNwLmRhdGEuZ3JhZGU7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIHRlbXBMaXN0LnB1c2goX3Jlc3AuZGF0YSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgYXZnID0gc3VtIC8gdGVtcExpc3QubGVuZ3RoOwogICAgICAgICAgICAgICAgdGhhdC5hdmdMaXN0LnB1c2goYXZnKTsKICAgICAgICAgICAgICAgIHRoYXQuc3VtTGlzdC5wdXNoKHN1bSk7CiAgICAgICAgICAgICAgICB0aGF0LmdyYWRlTGlzdC5wdXNoKHRlbXBMaXN0KTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhhdC5zdHVkZW50TGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIF9sb29wKGkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBQcm9taXNlLmFsbChyZXF1ZXN0czEpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlcykgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoYXQuc3R1ZGVudExpc3QpOwoKICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgdGhhdC5zdHVkZW50TGlzdC5sZW5ndGg7IF9pKyspIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhhdC5zdHVkZW50TGlzdC5sZW5ndGggLSBfaSAtIDE7IGorKykgewogICAgICAgICAgICAgICAgICBpZiAodGhhdC5hdmdMaXN0W2pdIDwgdGhhdC5hdmdMaXN0W2ogKyAxXSkgewogICAgICAgICAgICAgICAgICAgIHZhciB0ID0gdGhhdC5hdmdMaXN0W2pdOwogICAgICAgICAgICAgICAgICAgIHRoYXQuYXZnTGlzdFtqXSA9IHRoYXQuYXZnTGlzdFtqICsgMV07CiAgICAgICAgICAgICAgICAgICAgdGhhdC5hdmdMaXN0W2ogKyAxXSA9IHQ7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2codGhhdC5zdHVkZW50TGlzdFtqICsgMV0pOwogICAgICAgICAgICAgICAgICAgIHQgPSB0aGF0LnN0dWRlbnRMaXN0W2pdOwogICAgICAgICAgICAgICAgICAgIHRoYXQuc3R1ZGVudExpc3Rbal0gPSB0aGF0LnN0dWRlbnRMaXN0W2ogKyAxXTsKICAgICAgICAgICAgICAgICAgICB0aGF0LnN0dWRlbnRMaXN0W2ogKyAxXSA9IHQ7CiAgICAgICAgICAgICAgICAgICAgdCA9IHRoYXQuZ3JhZGVMaXN0W2pdOwogICAgICAgICAgICAgICAgICAgIHRoYXQuZ3JhZGVMaXN0W2pdID0gdGhhdC5ncmFkZUxpc3RbaiArIDFdOwogICAgICAgICAgICAgICAgICAgIHRoYXQuZ3JhZGVMaXN0W2ogKyAxXSA9IHQ7CiAgICAgICAgICAgICAgICAgICAgdCA9IHRoYXQuc3VtTGlzdFtqXTsKICAgICAgICAgICAgICAgICAgICB0aGF0LnN1bUxpc3Rbal0gPSB0aGF0LnN1bUxpc3RbaiArIDFdOwogICAgICAgICAgICAgICAgICAgIHRoYXQuc3VtTGlzdFtqICsgMV0gPSB0OwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfQp9Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6EA;AACA;AACAA,MADA,kBACA;AACA;AACAC,mBADA;AAEAC,qBAFA;AAGAC,oBAHA;AAIAC,mBAJA;AAKAC,iBALA;AAMAC,iBANA;AAOAC;AACAC;AADA;AAPA;AAWA,GAbA;AAcAC;AACAC,gBADA,0BACA;AACA;AACA;AACAC;AAEA;AACA;AAEAA;AACA;AAVA,GAdA;AA0BAC,SA1BA,qBA0BA;AACA;AACAC;AAEAC;AACAD;AACA,KAFA;AAGA,GAjCA;AAkCAE;AACA;AACAC,aADA,mBACAC,SADA,EACAC,GADA,EACA;AACA;AACAJ;AACAD;AACAM;AACAL;AACAD;AACA;;AAFA,uCAGAO,CAHA;AAIA;AACA,gCALA,CAMA;;AACA;AACA;AACAC;AACAC;AACA,eAXA,CAYA;;;AACAC;AACA;AACA;AACA,kCAHA,CAIA;;AACA;AACA;AACAJ;;AAEA;AACAK;AACA;;AACAC;AACA;;AACAC;AACAb;AACAA;AACAA;AACA,eAlBA;AAbA;;AAGA;AAAA;AA6BA;;AACAU;AACAJ;;AACA;AACA;AACA;AACA;AACAN;AACAA;AACAM;AACAQ;AACAd;AACAA;AAEAc;AACAd;AACAA;AACAc;AACAd;AACAA;AACA;AACA;AACA;AACA,aAtBA;AAuBA,WAxDA;AAyDA,SA5DA;AA6DA;AAhEA;AADA;AAlCA","names":["data","classList","studentList","courseList","gradeList","sumList","avgList","ruleForm","classIdChoose","methods","exportGrades","XLSX","created","that","axios","watch","handler","newChoose","old","console","i","requests","requests1","Promise","sum","tempList","avg","t"],"sourceRoot":"src/views/Teacher/teacherGradeCourseManage","sources":["teacherQueryGradeCourse.vue"],"sourcesContent":["<template>\n  <div>\n    <el-container>\n      <el-main>\n        <el-card>\n          <el-form>\n            <el-form-item label=\"班级名称\" prop=\"classChoose\">\n              <el-select v-model=\"ruleForm.classIdChoose\" placeholder=\"请选择\">\n                <el-option\n                  v-for=\"classes in classList\"\n                  :key=\"classes.id\"\n                  :label=\"classes.name\"\n                  :value=\"classes.id\"\n                ></el-option>\n              </el-select>\n            </el-form-item>\n          </el-form>\n        </el-card>\n        <table class=\"styled-table\">\n          <thead>\n            <tr>\n              <th>姓名</th>\n              <template v-for=\"course in courseList\">\n                <th>{{ course.cname }}</th>\n              </template>\n              <th>总分</th>\n              <th>平均分</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(student, index) in studentList\" :key=\"index\">\n              <td>{{ student.sname }}</td>\n              <template v-for=\"grade in gradeList[index]\">\n                <td v-if=\"grade != null\">{{ grade.grade }}</td>\n                <td v-else>无</td>\n              </template>\n              <td>{{ sumList[index] }}</td>\n              <td>{{ avgList[index] }}</td>\n            </tr>\n          </tbody>\n        </table>\n      </el-main>\n    </el-container>\n    <button @click=\"exportGrades\">导出成绩</button>\n  </div>\n</template>\n\n<style>\n.styled-table {\n  width: 100%;\n  border-collapse: collapse;\n  margin-top: 20px;\n}\n\n.styled-table th,\n.styled-table td {\n  padding: 10px;\n  border: 1px solid #ccc;\n  text-align: center;\n}\n\n.styled-table th {\n  background-color: #f2f2f2;\n  font-weight: bold;\n}\n\n.styled-table tr:nth-child(even) {\n  background-color: #f8f8f8;\n}\n\n.styled-table tr:hover {\n  background-color: #e2e2e2;\n}\n</style>\n\n\n<script>\nimport * as XLSX from 'xlsx';\nexport default {\n  data() {\n    return {\n      classList: [],\n      studentList: [],\n      courseList: [],\n      gradeList: [],\n      sumList: [],\n      avgList: [],\n      ruleForm: {\n        classIdChoose: \"\",\n      }\n    };\n  },\n  methods: {\n    exportGrades() {\n      const worksheet = XLSX.utils.table_to_sheet(this.$refs.gradeList);\n      const workbook = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(workbook, worksheet, '成绩表');\n\n      const today = new Date();\n      const filename = `成绩表_${today.getFullYear()}${today.getMonth() + 1}${today.getDate()}.xlsx`;\n\n      XLSX.writeFile(workbook, filename);\n    }\n  },\n  created() {\n    const that = this\n    that.tid = sessionStorage.getItem('tid');\n\n    axios.get(\"http://localhost:10086/course/findClassId?tid=\" + this.tid).then(function (resp) {\n      that.classList = resp.data;\n    })\n  },\n  watch: {\n    \"ruleForm.classIdChoose\": {\n      handler(newChoose, old) {\n        const that = this\n        axios.get(\"http://localhost:10086/student/findByClassName?classId=\" + newChoose).then(function (resp) {\n          that.studentList = resp.data;\n          console.log(that.studentList);\n          axios.get(\"http://localhost:10086/course/findByClassId?classid=\" + newChoose).then(function (resp) {\n            that.courseList = resp.data;\n            const requests1 = [];\n            for (let i = 0; i < that.studentList.length; i++) {\n              // 定义一个数组来保存所有的异步请求\n              const requests = [];\n              // 发起异步请求\n              for (let j = 0; j < that.courseList.length; j++) {\n                const request = axios.get(\"http://localhost:10086/SCT/find?sid=\" + that.studentList[i].sid + \"&cid=\" + that.courseList[j].cid);\n                requests.push(request);\n                requests1.push(request);\n              }\n              // 使用 Promise.all 等待所有异步请求完成\n              Promise.all(requests).then(function (responses) {\n                let sum = 0.0;\n                let avg = 0.0;\n                let tempList = [];\n                // 处理每个异步请求的响应\n                for (let k = 0; k < requests.length; k ++) {\n                  const resp = responses[k];\n                  console.log(resp);\n\n                  if (resp.data != null) {\n                    sum = sum + resp.data.grade;\n                  }\n                  tempList.push(resp.data);\n                }\n                avg = sum / tempList.length;\n                that.avgList.push(avg);\n                that.sumList.push(sum);\n                that.gradeList.push(tempList);\n              });\n            }\n            Promise.all(requests1).then(function (responses) {\n              console.log(that.studentList);\n              for (let i = 0; i < that.studentList.length; i++) {\n                for (let j = 0; j < that.studentList.length - i - 1; j++) {\n                  if (that.avgList[j] < that.avgList[j + 1]) {\n                    let t = that.avgList[j];\n                    that.avgList[j] = that.avgList[j + 1];\n                    that.avgList[j + 1] = t;\n                    console.log(that.studentList[j + 1]);\n                    t = that.studentList[j];\n                    that.studentList[j] = that.studentList[j + 1];\n                    that.studentList[j + 1] = t;\n                    \n                    t = that.gradeList[j];\n                    that.gradeList[j] = that.gradeList[j + 1];\n                    that.gradeList[j + 1] = t;\n                    t = that.sumList[j];\n                    that.sumList[j] = that.sumList[j + 1];\n                    that.sumList[j + 1] = t;\n                  }\n                }\n              }\n            })\n          })\n        }\n      )}\n    }\n  }\n}\n</script>"]}]}