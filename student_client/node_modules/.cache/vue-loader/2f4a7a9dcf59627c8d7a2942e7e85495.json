{"remainingRequest":"D:\\Idea项目\\Student\\student_client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Idea项目\\Student\\student_client\\src\\views\\Teacher\\teacherGradeCourseManage\\teacherQueryGradeCourse.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Idea项目\\Student\\student_client\\src\\views\\Teacher\\teacherGradeCourseManage\\teacherQueryGradeCourse.vue","mtime":1687272485097},{"path":"D:\\Idea项目\\Student\\student_client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1685794117013},{"path":"D:\\Idea项目\\Student\\student_client\\node_modules\\babel-loader\\lib\\index.js","mtime":1685794121019},{"path":"D:\\Idea项目\\Student\\student_client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1685794117013},{"path":"D:\\Idea项目\\Student\\student_client\\node_modules\\vue-loader\\lib\\index.js","mtime":1685794120760}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAqIGFzIFhMU1ggZnJvbSAneGxzeCc7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY2xhc3NMaXN0OiBbXSwKICAgICAgc3R1ZGVudExpc3Q6IFtdLAogICAgICBjb3Vyc2VMaXN0OiBbXSwKICAgICAgZ3JhZGVMaXN0OiBbXSwKICAgICAgc3VtTGlzdDogW10sCiAgICAgIGF2Z0xpc3Q6IFtdLAogICAgICBydWxlRm9ybTogewogICAgICAgIGNsYXNzSWRDaG9vc2U6ICIiLAogICAgICB9CiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgZXhwb3J0R3JhZGVzKCkgewogICAgICBjb25zdCB0YWJsZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3R5bGVkLXRhYmxlJyk7IC8vIOS9v+eUqOebuOW6lOeahCBIVE1MIOihqOagvOWFg+e0oOeahCBJRCDmiJblhbbku5bpgInmi6nlmajmnaXojrflj5booajmoLzlhYPntKAKICAgICAgY29uc3Qgd29ya3NoZWV0ID0gWExTWC51dGlscy50YWJsZV90b19zaGVldCh0YWJsZUVsZW1lbnQpOwoKICAgICAgY29uc3Qgd29ya2Jvb2sgPSBYTFNYLnV0aWxzLmJvb2tfbmV3KCk7CiAgICAgIFhMU1gudXRpbHMuYm9va19hcHBlbmRfc2hlZXQod29ya2Jvb2ssIHdvcmtzaGVldCwgJ+aIkOe7qeihqCcpOwoKICAgICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpOwogICAgICBjb25zdCBmaWxlbmFtZSA9IGDmiJDnu6nooahfJHt0b2RheS5nZXRGdWxsWWVhcigpfSR7dG9kYXkuZ2V0TW9udGgoKSArIDF9JHt0b2RheS5nZXREYXRlKCl9Lnhsc3hgOwoKICAgICAgWExTWC53cml0ZUZpbGUod29ya2Jvb2ssIGZpbGVuYW1lKTsKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICBjb25zdCB0aGF0ID0gdGhpcwogICAgdGhhdC50aWQgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCd0aWQnKTsKCiAgICBheGlvcy5nZXQoImh0dHA6Ly9sb2NhbGhvc3Q6MTAwODYvY291cnNlL2ZpbmRDbGFzc0lkP3RpZD0iICsgdGhpcy50aWQpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgdGhhdC5jbGFzc0xpc3QgPSByZXNwLmRhdGE7CiAgICB9KQogIH0sCiAgd2F0Y2g6IHsKICAgICJydWxlRm9ybS5jbGFzc0lkQ2hvb3NlIjogewogICAgICBoYW5kbGVyKG5ld0Nob29zZSwgb2xkKSB7CiAgICAgICAgY29uc3QgdGhhdCA9IHRoaXMKICAgICAgICBheGlvcy5nZXQoImh0dHA6Ly9sb2NhbGhvc3Q6MTAwODYvc3R1ZGVudC9maW5kQnlDbGFzc05hbWU/Y2xhc3NJZD0iICsgbmV3Q2hvb3NlKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgICB0aGF0LnN0dWRlbnRMaXN0ID0gcmVzcC5kYXRhOwogICAgICAgICAgY29uc29sZS5sb2codGhhdC5zdHVkZW50TGlzdCk7CiAgICAgICAgICBheGlvcy5nZXQoImh0dHA6Ly9sb2NhbGhvc3Q6MTAwODYvY291cnNlL2ZpbmRCeUNsYXNzSWQ/Y2xhc3NpZD0iICsgbmV3Q2hvb3NlKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgICAgIHRoYXQuY291cnNlTGlzdCA9IHJlc3AuZGF0YTsKICAgICAgICAgICAgY29uc3QgcmVxdWVzdHMxID0gW107CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhhdC5zdHVkZW50TGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIC8vIOWumuS5ieS4gOS4quaVsOe7hOadpeS/neWtmOaJgOacieeahOW8guatpeivt+axggogICAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RzID0gW107CiAgICAgICAgICAgICAgLy8g5Y+R6LW35byC5q2l6K+35rGCCiAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGF0LmNvdXJzZUxpc3QubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlcXVlc3QgPSBheGlvcy5nZXQoImh0dHA6Ly9sb2NhbGhvc3Q6MTAwODYvU0NUL2ZpbmQ/c2lkPSIgKyB0aGF0LnN0dWRlbnRMaXN0W2ldLnNpZCArICImY2lkPSIgKyB0aGF0LmNvdXJzZUxpc3Rbal0uY2lkKTsKICAgICAgICAgICAgICAgIHJlcXVlc3RzLnB1c2gocmVxdWVzdCk7CiAgICAgICAgICAgICAgICByZXF1ZXN0czEucHVzaChyZXF1ZXN0KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8g5L2/55SoIFByb21pc2UuYWxsIOetieW+heaJgOacieW8guatpeivt+axguWujOaIkAogICAgICAgICAgICAgIFByb21pc2UuYWxsKHJlcXVlc3RzKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZXMpIHsKICAgICAgICAgICAgICAgIGxldCBzdW0gPSAwLjA7CiAgICAgICAgICAgICAgICBsZXQgYXZnID0gMC4wOwogICAgICAgICAgICAgICAgbGV0IHRlbXBMaXN0ID0gW107CiAgICAgICAgICAgICAgICAvLyDlpITnkIbmr4/kuKrlvILmraXor7fmsYLnmoTlk43lupQKICAgICAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgcmVxdWVzdHMubGVuZ3RoOyBrICsrKSB7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3AgPSByZXNwb25zZXNba107CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3ApOwoKICAgICAgICAgICAgICAgICAgaWYgKHJlc3AuZGF0YSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgc3VtID0gc3VtICsgcmVzcC5kYXRhLmdyYWRlOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIHRlbXBMaXN0LnB1c2gocmVzcC5kYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGF2ZyA9IHN1bSAvIHRlbXBMaXN0Lmxlbmd0aDsKICAgICAgICAgICAgICAgIHRoYXQuYXZnTGlzdC5wdXNoKGF2Zyk7CiAgICAgICAgICAgICAgICB0aGF0LnN1bUxpc3QucHVzaChzdW0pOwogICAgICAgICAgICAgICAgdGhhdC5ncmFkZUxpc3QucHVzaCh0ZW1wTGlzdCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgUHJvbWlzZS5hbGwocmVxdWVzdHMxKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZXMpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0aGF0LnN0dWRlbnRMaXN0KTsKICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoYXQuc3R1ZGVudExpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhhdC5zdHVkZW50TGlzdC5sZW5ndGggLSBpIC0gMTsgaisrKSB7CiAgICAgICAgICAgICAgICAgIGlmICh0aGF0LmF2Z0xpc3Rbal0gPCB0aGF0LmF2Z0xpc3RbaiArIDFdKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHQgPSB0aGF0LmF2Z0xpc3Rbal07CiAgICAgICAgICAgICAgICAgICAgdGhhdC5hdmdMaXN0W2pdID0gdGhhdC5hdmdMaXN0W2ogKyAxXTsKICAgICAgICAgICAgICAgICAgICB0aGF0LmF2Z0xpc3RbaiArIDFdID0gdDsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0aGF0LnN0dWRlbnRMaXN0W2ogKyAxXSk7CiAgICAgICAgICAgICAgICAgICAgdCA9IHRoYXQuc3R1ZGVudExpc3Rbal07CiAgICAgICAgICAgICAgICAgICAgdGhhdC5zdHVkZW50TGlzdFtqXSA9IHRoYXQuc3R1ZGVudExpc3RbaiArIDFdOwogICAgICAgICAgICAgICAgICAgIHRoYXQuc3R1ZGVudExpc3RbaiArIDFdID0gdDsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB0ID0gdGhhdC5ncmFkZUxpc3Rbal07CiAgICAgICAgICAgICAgICAgICAgdGhhdC5ncmFkZUxpc3Rbal0gPSB0aGF0LmdyYWRlTGlzdFtqICsgMV07CiAgICAgICAgICAgICAgICAgICAgdGhhdC5ncmFkZUxpc3RbaiArIDFdID0gdDsKICAgICAgICAgICAgICAgICAgICB0ID0gdGhhdC5zdW1MaXN0W2pdOwogICAgICAgICAgICAgICAgICAgIHRoYXQuc3VtTGlzdFtqXSA9IHRoYXQuc3VtTGlzdFtqICsgMV07CiAgICAgICAgICAgICAgICAgICAgdGhhdC5zdW1MaXN0W2ogKyAxXSA9IHQ7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgKX0KICAgIH0KICB9Cn0K"},{"version":3,"sources":["teacherQueryGradeCourse.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"teacherQueryGradeCourse.vue","sourceRoot":"src/views/Teacher/teacherGradeCourseManage","sourcesContent":["<template>\n  <div>\n    <el-container>\n      <el-main>\n        <el-card>\n          <el-form>\n            <el-form-item label=\"班级名称\" prop=\"classChoose\">\n              <el-select v-model=\"ruleForm.classIdChoose\" placeholder=\"请选择\">\n                <el-option\n                  v-for=\"classes in classList\"\n                  :key=\"classes.id\"\n                  :label=\"classes.name\"\n                  :value=\"classes.id\"\n                ></el-option>\n              </el-select>\n            </el-form-item>\n          </el-form>\n        </el-card>\n        <table class=\"styled-table\" id=\"styled-table\">\n          <thead>\n            <tr>\n              <th>姓名</th>\n              <template v-for=\"course in courseList\">\n                <th>{{ course.cname }}</th>\n              </template>\n              <th>总分</th>\n              <th>平均分</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(student, index) in studentList\" :key=\"index\">\n              <td>{{ student.sname }}</td>\n              <template v-for=\"grade in gradeList[index]\">\n                <td v-if=\"grade != null\">{{ grade.grade }}</td>\n                <td v-else>无</td>\n              </template>\n              <td>{{ sumList[index] }}</td>\n              <td>{{ avgList[index] }}</td>\n            </tr>\n          </tbody>\n        </table>\n      </el-main>\n    </el-container>\n    <button @click=\"exportGrades\">导出成绩</button>\n  </div>\n</template>\n\n<style>\n.styled-table {\n  width: 100%;\n  border-collapse: collapse;\n  margin-top: 20px;\n}\n\n.styled-table th,\n.styled-table td {\n  padding: 10px;\n  border: 1px solid #ccc;\n  text-align: center;\n}\n\n.styled-table th {\n  background-color: #f2f2f2;\n  font-weight: bold;\n}\n\n.styled-table tr:nth-child(even) {\n  background-color: #f8f8f8;\n}\n\n.styled-table tr:hover {\n  background-color: #e2e2e2;\n}\n</style>\n\n\n<script>\nimport * as XLSX from 'xlsx';\nexport default {\n  data() {\n    return {\n      classList: [],\n      studentList: [],\n      courseList: [],\n      gradeList: [],\n      sumList: [],\n      avgList: [],\n      ruleForm: {\n        classIdChoose: \"\",\n      }\n    };\n  },\n  methods: {\n    exportGrades() {\n      const tableElement = document.getElementById('styled-table'); // 使用相应的 HTML 表格元素的 ID 或其他选择器来获取表格元素\n      const worksheet = XLSX.utils.table_to_sheet(tableElement);\n\n      const workbook = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(workbook, worksheet, '成绩表');\n\n      const today = new Date();\n      const filename = `成绩表_${today.getFullYear()}${today.getMonth() + 1}${today.getDate()}.xlsx`;\n\n      XLSX.writeFile(workbook, filename);\n    }\n  },\n  created() {\n    const that = this\n    that.tid = sessionStorage.getItem('tid');\n\n    axios.get(\"http://localhost:10086/course/findClassId?tid=\" + this.tid).then(function (resp) {\n      that.classList = resp.data;\n    })\n  },\n  watch: {\n    \"ruleForm.classIdChoose\": {\n      handler(newChoose, old) {\n        const that = this\n        axios.get(\"http://localhost:10086/student/findByClassName?classId=\" + newChoose).then(function (resp) {\n          that.studentList = resp.data;\n          console.log(that.studentList);\n          axios.get(\"http://localhost:10086/course/findByClassId?classid=\" + newChoose).then(function (resp) {\n            that.courseList = resp.data;\n            const requests1 = [];\n            for (let i = 0; i < that.studentList.length; i++) {\n              // 定义一个数组来保存所有的异步请求\n              const requests = [];\n              // 发起异步请求\n              for (let j = 0; j < that.courseList.length; j++) {\n                const request = axios.get(\"http://localhost:10086/SCT/find?sid=\" + that.studentList[i].sid + \"&cid=\" + that.courseList[j].cid);\n                requests.push(request);\n                requests1.push(request);\n              }\n              // 使用 Promise.all 等待所有异步请求完成\n              Promise.all(requests).then(function (responses) {\n                let sum = 0.0;\n                let avg = 0.0;\n                let tempList = [];\n                // 处理每个异步请求的响应\n                for (let k = 0; k < requests.length; k ++) {\n                  const resp = responses[k];\n                  console.log(resp);\n\n                  if (resp.data != null) {\n                    sum = sum + resp.data.grade;\n                  }\n                  tempList.push(resp.data);\n                }\n                avg = sum / tempList.length;\n                that.avgList.push(avg);\n                that.sumList.push(sum);\n                that.gradeList.push(tempList);\n              });\n            }\n            Promise.all(requests1).then(function (responses) {\n              console.log(that.studentList);\n              for (let i = 0; i < that.studentList.length; i++) {\n                for (let j = 0; j < that.studentList.length - i - 1; j++) {\n                  if (that.avgList[j] < that.avgList[j + 1]) {\n                    let t = that.avgList[j];\n                    that.avgList[j] = that.avgList[j + 1];\n                    that.avgList[j + 1] = t;\n                    console.log(that.studentList[j + 1]);\n                    t = that.studentList[j];\n                    that.studentList[j] = that.studentList[j + 1];\n                    that.studentList[j + 1] = t;\n                    \n                    t = that.gradeList[j];\n                    that.gradeList[j] = that.gradeList[j + 1];\n                    that.gradeList[j + 1] = t;\n                    t = that.sumList[j];\n                    that.sumList[j] = that.sumList[j + 1];\n                    that.sumList[j + 1] = t;\n                  }\n                }\n              }\n            })\n          })\n        }\n      )}\n    }\n  }\n}\n</script>"]}]}